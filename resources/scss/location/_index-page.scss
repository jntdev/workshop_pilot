@use '../base/colors' as *;
@use '../base/typos' as *;
@use '../base/rules' as *;

// Couleurs statut vélos
$color-status-ok: #22c55e; // Vert
$color-status-hs: #9ca3af; // Gris foncé pour HS

// Highlight
$highlight-brightness: 0.92;

// Gap entre catégories (équivalent à 3 colonnes de 40px)
$category-gap: 120px;

// Couleurs catégories vélos (Les Vélos d'Armor)
$color-category-vae: #FFD233; // Jaune VAE
$color-category-vtc: #005D66; // Bleu-vert VTC

// Page Location - Disponibilités vélos

// Bloquer le scroll global quand le calendrier location est présent
body:has(#location_calendar) {
  overflow: hidden;
}

.location {
  display: flex;
  height: calc(100vh - 84px);
  max-height: calc(100vh - 84px);
  overflow: hidden;
  width: 100vw;
  box-sizing: border-box;

  @media (max-width: 1279px) {
    flex-direction: column;
    height: auto;
    max-height: none;
    overflow: visible;
    width: 100%;
  }

  &__table-panel {
    width: 66vw;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    padding: 1rem;
    box-sizing: border-box;
    max-height: calc(100vh - 84px);

    @media (min-width: 1800px) {
      flex: 1;
      width: auto;
    }

    @media (max-width: 1279px) {
      width: 100%;
      max-height: none;
    }
  }

  &__form-panel {
    width: 33vw;
    max-width: 600px;
    height: calc(100vh - 84px);
    max-height: calc(100vh - 84px);
    background: $color-bg-light;
    border-left: 1px solid $color-border-light;
    padding: 1rem;
    overflow-y: auto;
    box-sizing: border-box;
    flex-shrink: 0;

    @media (min-width: 1800px) {
      width: 600px;
    }

    @media (max-width: 1279px) {
      width: 100%;
      max-width: none;
      height: auto;
      max-height: none;
      min-height: 200px;
      border-left: none;
      border-top: 1px solid $color-border-light;
    }
  }

  &__header {
    margin-bottom: 1rem;
  }

  &__title {
    font-size: 1.5rem;
    font-weight: 600;
    color: $color-neutral-dark;
    margin: 0;
  }

  &__form-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: $color-neutral-medium;
    text-align: center;
  }

  &__form-hint {
    font-size: 0.875rem;
    margin-top: 0.5rem;
  }
}

// Tableau des disponibilités

.location-table {
  width: max-content;
  min-width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  table-layout: fixed;

  &__container {
    flex: 1;
    overflow: auto;
    background: $color-bg-white;
    border: 1px solid $color-border-light;
    border-radius: 8px;
    min-width: 0;
    max-width: 100%;
  }

  &__head {
    position: sticky;
    top: 0;
    z-index: 10;
    background: $color-bg-light;
  }

  &__header-row {
    border-bottom: 2px solid $color-border-medium;
  }

  &__th {
    padding: 0.25rem 0.125rem;
    text-align: center;
    font-weight: 600;
    font-size: 0.625rem;
    color: $color-neutral-dark;
    border-bottom: 1px solid $color-border-medium;
    background: $color-bg-light;

    &:first-child {
      position: sticky;
      left: 0;
      z-index: 11;
      text-align: left;
      padding-left: 1rem;
    }
  }

  &__header-date {
    font-size: 0.875rem;
  }

  &__category-row {
    height: 20px;
  }

  &__th--category-empty {
    background: $color-bg-light;
    position: sticky;
    left: 0;
    z-index: 11;
  }

  &__th--category {
    font-weight: 700;
    font-size: 0.75rem;
    color: $color-bg-white;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  &__th--category-vae {
    background: $color-category-vae;
    color: $color-neutral-dark;
  }

  &__th--category-vtc {
    background: $color-category-vtc;
    color: $color-bg-white;
  }

  // Spacer entre les catégories
  &__spacer {
    background: $color-bg-light;
    height: 100%;
  }

  &__th--category-spacer {
    background: $color-bg-light;
  }

  &__header-bike {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
    padding: 0.25rem 0.125rem;
    border-radius: 2px;
    font-size: 0.625rem;

    &--ok {
      background: $color-status-ok;
    }

    &--hs {
      background: $color-status-hs;
    }

    &[data-column-hovered="true"] {
      filter: brightness($highlight-brightness);
    }
  }

  &__header-category {
    font-weight: 700;
    color: $color-primary-blue;
  }

  &__header-size {
    font-weight: 500;
    color: $color-neutral-medium;
  }


  &__row {
    &:hover {
      .location-table__date-cell {
        background: rgba($color-primary-blue, 0.12);
        font-weight: 600;
      }

      .location-table__cell {
        filter: brightness($highlight-brightness);
      }
    }
  }

  &__td {
    padding: 0;
    border-bottom: 1px solid $color-border-light;
    height: 24px;

    &:first-child {
      position: sticky;
      left: 0;
      z-index: 5;
      background: $color-bg-white;
      border-right: 1px solid $color-border-light;
    }
  }

  &__date-cell {
    display: flex;
    align-items: center;
    height: 100%;
    padding: 0 0.5rem;
    font-size: 0.625rem;
    color: $color-neutral-dark;

    &--weekend {
      background: rgba($color-neutral-light, 0.5);
      color: $color-neutral-medium;
    }
  }

  &__date-label {
    white-space: nowrap;
  }

  &__cell {
    display: flex;
    flex-direction: column;
    height: 100%;
    cursor: pointer;
    transition: background 0.15s ease, filter 0.15s ease;

    background: $color-bg-white;

    &:hover {
      filter: brightness(0.95);
    }

    &--today {
      .location-table__cell-banner {
        background: $color-primary-blue;
      }
    }

    &[data-column-hovered="true"] {
      filter: brightness($highlight-brightness);
    }

    &--hs {
      background: $color-status-hs !important;
      cursor: not-allowed;

      &:hover {
        filter: none;
      }
    }
  }

  &__cell-banner {
    flex: 0 0 4px;
    background: transparent;
    transition: background 0.15s ease;
  }

  &__cell-content {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
  }

  // Séparateurs verticaux - 3 niveaux d'importance
  &__separator--bike {
    border-left: 1px solid $color-border-light;
  }

  &__separator--size {
    border-left: 2px solid $color-border-medium;
  }

}